<?php
/*   __________________________________________________
    |            Code protected by Skyresoft           |
    |                                                  |
    |       webiste: https://www.skyresoft.com         |
    |__________________________________________________|
*/
 namespace App; use Brotzka\DotenvEditor\Exceptions\DotEnvException; use Dotenv\Exception\InvalidPathException; use Illuminate\Support\Str; class DotenvEditor { private $env; private $backupPath; private $autoBackup = false; public function __construct() { goto mbmpM; b02Sk: $env = config("\x64\x6f\164\x65\x6e\x76\145\x64\151\164\157\x72\x2e\160\141\164\x68\124\x6f\x45\156\x76"); goto AIw8u; M0OEv: B73T2: goto juFB5; juFB5: $this->env = $env; goto lgTow; AIw8u: $filePermissions = config("\144\x6f\x74\x65\156\166\x65\144\x69\164\x6f\162\x2e\x66\151\154\145\x50\145\x72\x6d\x69\163\x73\151\x6f\156\163"); goto V3bvU; V3bvU: if (file_exists($env)) { goto B73T2; } goto HHwlg; mbmpM: $backupPath = Str::finish(config("\144\x6f\164\x65\156\x76\x65\x64\x69\164\x6f\x72\x2e\x62\x61\x63\x6b\165\x70\120\141\x74\150"), "\57"); goto b02Sk; Aq0S2: $this->backupPath = $backupPath; goto maqFS; FljY4: s72dL: goto Aq0S2; lgTow: if (is_dir($backupPath)) { goto s72dL; } goto gJeYf; HHwlg: return false; goto M0OEv; gJeYf: mkdir($backupPath, $filePermissions, true); goto FljY4; maqFS: } public function getBackupPath() { return $this->backupPath; } public function setBackupPath($path) { goto HfteZ; HfteZ: if (is_dir($path)) { goto zmJX6; } goto p26Fk; WNe6M: zmJX6: goto AJBAs; AJBAs: $this->backupPath = $path; goto r_Bn1; p26Fk: try { mkdir($path, 0777, true); } catch (InvalidPathException $e) { echo htmlspecialchars($e->getMessage()); return false; } goto WNe6M; r_Bn1: return true; goto fgEg3; fgEg3: } public function keyExists($key) { $env = $this->getContent(); return array_key_exists($key, $env); } public function getValue($key) { goto qcJLP; sv4E3: goto sk4Nb; goto OudW2; XdbKp: return env($key); goto K7FFr; K7FFr: sk4Nb: goto HQa07; ELIvN: throw new DotEnvException(trans("\x64\x6f\164\x65\x6e\x76\55\x65\144\x69\164\157\x72\72\72\143\x6c\x61\x73\163\x2e\162\x65\161\165\x65\x73\x74\145\x64\x5f\x76\x61\154\165\x65\x5f\156\157\x74\x5f\x61\x76\x61\x69\x6c\141\142\x6c\145"), 0); goto sv4E3; OudW2: PIaUU: goto XdbKp; qcJLP: if ($this->keyExists($key)) { goto PIaUU; } goto ELIvN; HQa07: } public function setAutoBackup($onOff) { goto DSoQ6; jWBzy: goto AMXtH; goto eMdxT; eMdxT: Q1BqP: goto OGvSH; DSoQ6: if (is_bool($onOff)) { goto Q1BqP; } goto SIfNL; B2UDh: AMXtH: goto IBuhG; OGvSH: $this->autoBackup = $onOff; goto B2UDh; SIfNL: throw new DotEnvException(trans("\144\x6f\x74\145\x6e\x76\55\145\144\151\164\157\x72\72\x3a\143\154\141\x73\x73\x2e\141\x75\164\x6f\x62\141\x63\x6b\x75\160\x5f\x77\x72\x6f\156\147\x5f\166\x61\154\x75\x65"), 0); goto jWBzy; IBuhG: } public function autoBackupEnabled() { return $this->autoBackup; } public function createBackup() { return copy($this->env, $this->backupPath . time() . "\x5f\145\156\x76"); } protected function getLatestBackup() { goto QLRmB; hLJMK: $latestBackup = 0; goto R4HAx; R4HAx: foreach ($backups as $backup) { goto MXC0w; hh_QM: A2EXZ: goto S8sgz; S8sgz: nj8pq: goto ILO_j; JR5wx: $latestBackup = $backup; goto hh_QM; MXC0w: if (!($backup > $latestBackup)) { goto A2EXZ; } goto JR5wx; ILO_j: } goto oIGTC; oIGTC: kKYS4: goto gODDg; gODDg: return $latestBackup; goto yP3Jm; QLRmB: $backups = $this->getBackupVersions(); goto hLJMK; yP3Jm: } public function restoreBackup($timestamp = null) { goto FI8qE; FI8qE: $file = null; goto I3eP8; I3eP8: if ($timestamp !== null) { goto HjIBT; } goto mGSHY; rrDQD: e0ay7: goto C5Joj; mGSHY: $file = $this->getFile($this->getLatestBackup()["\x75\x6e\x66\157\162\x6d\141\164\x74\145\x64"]); goto x3SdS; C5Joj: EYkXM: goto idMgj; idMgj: return copy($file, $this->env); goto bqePK; AOibC: $file = $this->getFile($timestamp); goto rrDQD; Yqea2: if (!$this->getFile($timestamp)) { goto e0ay7; } goto AOibC; x3SdS: goto EYkXM; goto saQfc; saQfc: HjIBT: goto Yqea2; bqePK: } protected function getFile($timestamp) { goto DTwA6; bcfYX: fy8RQ: goto XzRqt; v5hV6: if (file_exists($file)) { goto CoD0a; } goto VULJn; eX1zH: return $file; goto bcfYX; VULJn: throw new DotEnvException(trans("\x64\157\164\145\x6e\166\x2d\145\x64\x69\x74\157\x72\72\72\143\x6c\141\x73\x73\56\x72\x65\161\x75\x65\x73\164\145\144\137\x62\x61\x63\x6b\x75\x70\x5f\156\157\x74\x5f\x66\x6f\165\156\x64"), 0); goto C2Qxu; P6z9j: CoD0a: goto eX1zH; DTwA6: $file = $this->getBackupPath() . $timestamp . "\x5f\145\156\x76"; goto v5hV6; C2Qxu: goto fy8RQ; goto P6z9j; XzRqt: } public function getBackupVersions() { goto KvG4R; Ma6Z_: WVPvr: goto akIGm; UJaWz: throw new DotEnvException(trans("\144\157\x74\145\x6e\x76\x2d\145\144\151\x74\157\162\x3a\x3a\143\x6c\141\x73\163\56\x6e\157\x5f\x62\141\143\x6b\x75\160\x73\x5f\x61\166\141\151\x6c\x61\142\x6c\x65"), 0); goto WJdxT; KcXlK: $output = []; goto q2sNf; akIGm: return $output; goto unGH0; q2sNf: $count = 0; goto sOT_1; KvG4R: $versions = array_diff(scandir($this->backupPath), ["\56\x2e", "\x2e"]); goto G_trY; sOT_1: foreach ($versions as $version) { goto DbdyO; DbdyO: $part = explode("\137", $version); goto Q4hfn; hICJx: $output[$count]["\165\x6e\146\157\x72\155\141\164\x74\145\x64"] = $part[0]; goto rxHz9; Q4hfn: $output[$count]["\146\157\x72\x6d\x61\x74\x74\145\x64"] = date("\x59\55\155\55\144\40\110\72\151\x3a\x73", (int) $part[0]); goto hICJx; eVue8: p5203: goto qjFZq; rxHz9: $count++; goto eVue8; qjFZq: } goto Ma6Z_; unGH0: r4Wr3: goto UJaWz; G_trY: if (!(count($versions) > 0)) { goto r4Wr3; } goto KcXlK; WJdxT: } public function getBackupFile($timestamp) { goto LpbHU; A6E8F: return $this->backupPath . $timestamp . "\137\x65\156\x76"; goto d1hXN; vmX0N: throw new DotEnvException(trans("\x64\x6f\x74\x65\156\x76\x2d\145\144\151\x74\157\x72\x3a\x3a\143\x6c\141\163\x73\56\162\x65\161\x75\145\x73\164\x65\144\137\142\141\x63\153\x75\x70\x5f\x6e\x6f\164\137\x66\x6f\165\x6e\144"), 0); goto yzUPE; LpbHU: if (!file_exists($this->getBackupPath() . $timestamp . "\x5f\x65\156\166")) { goto cjcCE; } goto A6E8F; d1hXN: cjcCE: goto vmX0N; yzUPE: } public function deleteBackup($timestamp) { goto kBmJv; TC3vY: goto TGh8Q; goto KgkWC; IGws3: if (file_exists($file)) { goto giISt; } goto GFD7_; KgkWC: giISt: goto xGe53; kBmJv: $file = $this->getBackupPath() . $timestamp . "\x5f\x65\156\x76"; goto IGws3; GFD7_: throw new DotEnvException(trans("\144\x6f\x74\x65\156\x76\55\x65\x64\151\x74\157\x72\72\72\x63\154\141\x73\163\56\x62\x61\143\153\165\160\137\x6e\x6f\x74\x5f\x64\x65\x6c\x65\x74\141\x62\x6c\x65"), 0); goto TC3vY; xGe53: unlink($file); goto sQ_Ul; sQ_Ul: TGh8Q: goto pn0rA; pn0rA: } public function getContent($timestamp = null) { goto WpHM0; lby4t: goto Wpaul; goto vbvOl; c0DQj: Wpaul: goto JGD_A; vbvOl: cH_Tu: goto nAZ8F; u9ubn: return $this->envToArray($this->getBackupFile($timestamp)); goto lby4t; WpHM0: if ($timestamp === null) { goto cH_Tu; } goto u9ubn; nAZ8F: return $this->envToArray($this->env); goto c0DQj; JGD_A: } protected function envToArray($file) { goto kCR6V; O6EsG: vdJdw: goto aM6GK; UN5VD: $string = preg_split("\x2f\x5c\x6e\x2b\57", $string); goto KpQQK; aM6GK: return array_filter($returnArray, function ($key) { return !empty($key); }, ARRAY_FILTER_USE_KEY); goto MiH8X; wN6hl: foreach ($string as $one) { goto gPaHb; CFzpk: Se9Hh: goto LUz6g; LUz6g: $entry = explode("\x3d", $one, 2); goto HbPPw; gPaHb: if (!(preg_match("\x2f\136\x28\43\x5c\x73\x29\57", $one) === 1 || preg_match("\57\x5e\50\133\134\x6e\x5c\162\135\53\51\57", $one))) { goto Se9Hh; } goto vlELO; yttx2: jcbJj: goto rxS69; vlELO: goto jcbJj; goto CFzpk; HbPPw: $returnArray[$entry[0]] = isset($entry[1]) ? $entry[1] : null; goto yttx2; rxS69: } goto O6EsG; KpQQK: $returnArray = []; goto wN6hl; kCR6V: $string = file_get_contents($file); goto UN5VD; MiH8X: } public function getAsJson($timestamp = null) { return $this->envToJson($this->getContent($timestamp)); } private function envToJson($file = array()) { goto fL9ML; TJZT3: foreach ($file as $key => $value) { goto lxOfm; lxOfm: $array[$c] = new \stdClass(); goto I4CxD; zwPb1: pocXp: goto GMm1g; dqn8r: $c++; goto zwPb1; Ldq_I: $array[$c]->value = $value; goto dqn8r; I4CxD: $array[$c]->key = $key; goto Ldq_I; GMm1g: } goto HSMNU; fL9ML: $array = []; goto LVDFu; HSMNU: cmIF0: goto bRgqj; LVDFu: $c = 0; goto TJZT3; bRgqj: return json_encode($array); goto DyntR; DyntR: } protected function save($array) { goto t2bVC; d4YWk: $c = 0; goto EGPK8; niG8b: ltN3S: goto V3S3w; DgAC8: file_put_contents($this->env, $newArray); goto aiEyq; V3S3w: $newArray = implode("\xa", $newArray); goto DgAC8; LlMtx: Ni7wq: goto vN3_z; aiEyq: return true; goto LlMtx; S3Bhc: $newArray = []; goto d4YWk; vN3_z: return false; goto QKssx; t2bVC: if (!is_array($array)) { goto Ni7wq; } goto S3Bhc; EGPK8: foreach ($array as $key => $value) { goto OpnDp; OpnDp: if (!(preg_match("\x2f\x5c\x73\57", $value) > 0 && (strpos($value, "\42") > 0 && strpos($value, "\x22", -0) > 0))) { goto TyvUg; } goto s97TC; Fhay8: TyvUg: goto qBAmX; qBAmX: $newArray[$c] = $key . "\75" . $value; goto J9y2J; s97TC: $value = "\42" . $value . "\42"; goto Fhay8; J9y2J: $c++; goto YX2UP; YX2UP: Av6y3: goto gz3Vt; gz3Vt: } goto niG8b; QKssx: } public function changeEnv($data = array()) { goto SY2YH; u3yQY: if (!$this->autoBackupEnabled()) { goto sVNcO; } goto Sznlx; tj4Ry: sVNcO: goto IlDNV; jH6uj: throw new DotEnvException(trans("\x64\157\164\145\x6e\166\x2d\145\x64\x69\x74\157\162\72\x3a\143\154\x61\163\163\x2e\x61\162\162\x61\x79\x5f\156\145\x65\x64\145\x64"), 0); goto aEdiQ; YTrjO: UxHll: goto a1XiR; DBgWw: foreach ($data as $dataKey => $dataValue) { goto eiSap; xlPEx: jG1Qh: goto QHrKS; CUlFI: z0Ufz: goto xlPEx; eiSap: foreach (array_keys($env) as $envKey) { goto Z_nqG; ZjGFs: $env[$envKey] = $dataValue; goto KgvlN; Z_nqG: if (!($dataKey === $envKey)) { goto lz8bX; } goto ZjGFs; KgvlN: lz8bX: goto OTFN2; OTFN2: XKL_f: goto Py88h; Py88h: } goto CUlFI; QHrKS: } goto YTrjO; IlDNV: $env = $this->getContent(); goto DBgWw; uTcsa: mGp1G: goto jH6uj; a1XiR: return $this->save($env); goto uTcsa; Sznlx: $this->createBackup(); goto tj4Ry; SY2YH: if (!(count($data) > 0)) { goto mGp1G; } goto u3yQY; aEdiQ: } public function addData($data = array()) { goto BeL5I; R0C85: $this->createBackup(); goto u2N2J; wkLF0: foreach ($data as $key => $value) { $env[$key] = $this->santize($value); YiX4B: } goto nm9Ob; gUNRP: $env = $this->getContent(); goto wkLF0; Qr6nx: throw new DotEnvException(trans("\x64\157\x74\145\x6e\x76\55\145\x64\x69\164\157\x72\x3a\72\143\x6c\141\x73\163\x2e\141\162\x72\x61\x79\x5f\156\x65\x65\144\x65\144"), 0); goto Kg0dg; BeL5I: if (!(count($data) > 0)) { goto VkqZT; } goto Zb3Hp; R3mqS: VkqZT: goto Qr6nx; Zb3Hp: if (!$this->autoBackupEnabled()) { goto fa2Ak; } goto R0C85; TcYU2: return $this->save($env); goto R3mqS; u2N2J: fa2Ak: goto gUNRP; nm9Ob: irJeE: goto TcYU2; Kg0dg: } public function santize($value = '') { goto ifObf; NEANw: $value = $this->setStartAndEndWith($value, "\x27"); goto JEvdF; Wkq3W: O4Tvd: goto IhraS; ifObf: if (!$this->isStartOrEndWith($value, "\x27")) { goto tMeZa; } goto NEANw; M8Afa: $value = $this->setStartAndEndWith($value, "\x22"); goto Wkq3W; IhraS: return $value; goto rDLW8; PxVta: if (!$this->isStartOrEndWith($value, "\x22")) { goto ABo59; } goto CmWA7; vu7m8: if (!preg_match("\x2f\134\163\57", $value)) { goto O4Tvd; } goto M8Afa; uX5QY: ABo59: goto vu7m8; CmWA7: $value = $this->setStartAndEndWith($value, "\42"); goto uX5QY; JEvdF: tMeZa: goto PxVta; rDLW8: } public function isStartOrEndWith($value, $string = '') { return Str::startsWith($value, $string) || Str::endsWith($value, $string); } public function setStartAndEndWith($value, $string = "\42") { goto Jsk8T; NQjcB: $value = Str::finish($value, $string); goto L3tPY; Jsk8T: $value = Str::start($value, $string); goto NQjcB; L3tPY: return $value; goto pqzFQ; pqzFQ: } public function deleteData($data = array()) { goto NproT; iGOK5: cp0my: goto Fhixd; sgISK: vsw5X: goto sLlpG; Fhixd: return $this->save($env); goto TIPxC; NproT: foreach ($data as $key => $value) { goto m4hgQ; zDZv_: rgseh: goto K13Og; K13Og: pG0XO: goto BHJnl; bm21W: throw new DotEnvException("\x64\x6f\x74\x65\x6e\x76\55\145\144\x69\x74\157\162\x3a\x3a\x63\154\x61\x73\163\x2e\156\x75\x6d\145\x72\x69\x63\x5f\141\162\162\x61\171\x5f\x6e\x65\145\x64\x65\x64", 0); goto zDZv_; m4hgQ: if (is_numeric($key)) { goto rgseh; } goto bm21W; BHJnl: } goto sgISK; JY2Vw: foreach ($data as $delete) { goto NgsGx; NgsGx: foreach ($env as $key => $value) { goto Yhpxw; Yhpxw: if (!($delete === $key)) { goto nyZOH; } goto Cfr2P; Cfr2P: unset($env[$key]); goto sRuv0; sRuv0: nyZOH: goto vMoYJ; vMoYJ: DepUt: goto rrILr; rrILr: } goto zBLiF; zBLiF: L6led: goto FKvFb; FKvFb: Xhcef: goto Qcblc; Qcblc: } goto iGOK5; sLlpG: if (!$this->autoBackupEnabled()) { goto au4oc; } goto wiNw4; wiNw4: $this->createBackup(); goto OhRPl; Hwq4x: $env = $this->getContent(); goto JY2Vw; OhRPl: au4oc: goto Hwq4x; TIPxC: } }
